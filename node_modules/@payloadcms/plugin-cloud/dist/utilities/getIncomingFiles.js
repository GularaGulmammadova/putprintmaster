"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "getIncomingFiles", {
    enumerable: true,
    get: function() {
        return getIncomingFiles;
    }
});
function getIncomingFiles({ data, req }) {
    const file = req.files?.file;
    let files = [];
    if (file && data.filename && data.mimeType) {
        const mainFile = {
            buffer: file.data,
            filename: data.filename,
            filesize: file.size,
            mimeType: data.mimeType,
            tempFilePath: file.tempFilePath
        };
        files = [
            mainFile
        ];
        if (data?.sizes) {
            Object.entries(data.sizes).forEach(([key, resizedFileData])=>{
                if (req.payloadUploadSizes?.[key] && data.mimeType) {
                    files = files.concat([
                        {
                            buffer: req.payloadUploadSizes[key],
                            filename: `${resizedFileData.filename}`,
                            filesize: req.payloadUploadSizes[key].length,
                            mimeType: data.mimeType
                        }
                    ]);
                }
            });
        }
    }
    return files;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsaXRpZXMvZ2V0SW5jb21pbmdGaWxlcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEZpbGVEYXRhIH0gZnJvbSAncGF5bG9hZC90eXBlcydcbmltcG9ydCB0eXBlIHsgUGF5bG9hZFJlcXVlc3QgfSBmcm9tICdwYXlsb2FkL3R5cGVzJ1xuXG5pbXBvcnQgdHlwZSB7IEZpbGUgfSBmcm9tICcuLi90eXBlcydcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEluY29taW5nRmlsZXMoe1xuICBkYXRhLFxuICByZXEsXG59OiB7XG4gIGRhdGE6IFBhcnRpYWw8RmlsZURhdGE+XG4gIHJlcTogUGF5bG9hZFJlcXVlc3Rcbn0pOiBGaWxlW10ge1xuICBjb25zdCBmaWxlID0gcmVxLmZpbGVzPy5maWxlXG5cbiAgbGV0IGZpbGVzOiBGaWxlW10gPSBbXVxuXG4gIGlmIChmaWxlICYmIGRhdGEuZmlsZW5hbWUgJiYgZGF0YS5taW1lVHlwZSkge1xuICAgIGNvbnN0IG1haW5GaWxlOiBGaWxlID0ge1xuICAgICAgYnVmZmVyOiBmaWxlLmRhdGEsXG4gICAgICBmaWxlbmFtZTogZGF0YS5maWxlbmFtZSxcbiAgICAgIGZpbGVzaXplOiBmaWxlLnNpemUsXG4gICAgICBtaW1lVHlwZTogZGF0YS5taW1lVHlwZSxcbiAgICAgIHRlbXBGaWxlUGF0aDogZmlsZS50ZW1wRmlsZVBhdGgsXG4gICAgfVxuXG4gICAgZmlsZXMgPSBbbWFpbkZpbGVdXG5cbiAgICBpZiAoZGF0YT8uc2l6ZXMpIHtcbiAgICAgIE9iamVjdC5lbnRyaWVzKGRhdGEuc2l6ZXMpLmZvckVhY2goKFtrZXksIHJlc2l6ZWRGaWxlRGF0YV0pID0+IHtcbiAgICAgICAgaWYgKHJlcS5wYXlsb2FkVXBsb2FkU2l6ZXM/LltrZXldICYmIGRhdGEubWltZVR5cGUpIHtcbiAgICAgICAgICBmaWxlcyA9IGZpbGVzLmNvbmNhdChbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGJ1ZmZlcjogcmVxLnBheWxvYWRVcGxvYWRTaXplc1trZXldLFxuICAgICAgICAgICAgICBmaWxlbmFtZTogYCR7cmVzaXplZEZpbGVEYXRhLmZpbGVuYW1lfWAsXG4gICAgICAgICAgICAgIGZpbGVzaXplOiByZXEucGF5bG9hZFVwbG9hZFNpemVzW2tleV0ubGVuZ3RoLFxuICAgICAgICAgICAgICBtaW1lVHlwZTogZGF0YS5taW1lVHlwZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSlcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZmlsZXNcbn1cbiJdLCJuYW1lcyI6WyJnZXRJbmNvbWluZ0ZpbGVzIiwiZGF0YSIsInJlcSIsImZpbGUiLCJmaWxlcyIsImZpbGVuYW1lIiwibWltZVR5cGUiLCJtYWluRmlsZSIsImJ1ZmZlciIsImZpbGVzaXplIiwic2l6ZSIsInRlbXBGaWxlUGF0aCIsInNpemVzIiwiT2JqZWN0IiwiZW50cmllcyIsImZvckVhY2giLCJrZXkiLCJyZXNpemVkRmlsZURhdGEiLCJwYXlsb2FkVXBsb2FkU2l6ZXMiLCJjb25jYXQiLCJsZW5ndGgiXSwicmFuZ2VNYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzsiLCJtYXBwaW5ncyI6Ijs7OzsrQkFLZ0JBOzs7ZUFBQUE7OztBQUFULFNBQVNBLGlCQUFpQixFQUMvQkMsSUFBSSxFQUNKQyxHQUFHLEVBSUo7SUFDQyxNQUFNQyxPQUFPRCxJQUFJRSxLQUFLLEVBQUVEO0lBRXhCLElBQUlDLFFBQWdCLEVBQUU7SUFFdEIsSUFBSUQsUUFBUUYsS0FBS0ksUUFBUSxJQUFJSixLQUFLSyxRQUFRLEVBQUU7UUFDMUMsTUFBTUMsV0FBaUI7WUFDckJDLFFBQVFMLEtBQUtGLElBQUk7WUFDakJJLFVBQVVKLEtBQUtJLFFBQVE7WUFDdkJJLFVBQVVOLEtBQUtPLElBQUk7WUFDbkJKLFVBQVVMLEtBQUtLLFFBQVE7WUFDdkJLLGNBQWNSLEtBQUtRLFlBQVk7UUFDakM7UUFFQVAsUUFBUTtZQUFDRztTQUFTO1FBRWxCLElBQUlOLE1BQU1XLE9BQU87WUFDZkMsT0FBT0MsT0FBTyxDQUFDYixLQUFLVyxLQUFLLEVBQUVHLE9BQU8sQ0FBQyxDQUFDLENBQUNDLEtBQUtDLGdCQUFnQjtnQkFDeEQsSUFBSWYsSUFBSWdCLGtCQUFrQixFQUFFLENBQUNGLElBQUksSUFBSWYsS0FBS0ssUUFBUSxFQUFFO29CQUNsREYsUUFBUUEsTUFBTWUsTUFBTSxDQUFDO3dCQUNuQjs0QkFDRVgsUUFBUU4sSUFBSWdCLGtCQUFrQixDQUFDRixJQUFJOzRCQUNuQ1gsVUFBVSxDQUFDLEVBQUVZLGdCQUFnQlosUUFBUSxDQUFDLENBQUM7NEJBQ3ZDSSxVQUFVUCxJQUFJZ0Isa0JBQWtCLENBQUNGLElBQUksQ0FBQ0ksTUFBTTs0QkFDNUNkLFVBQVVMLEtBQUtLLFFBQVE7d0JBQ3pCO3FCQUNEO2dCQUNIO1lBQ0Y7UUFDRjtJQUNGO0lBRUEsT0FBT0Y7QUFDVCJ9