"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "sanitizeQueryValue", {
    enumerable: true,
    get: function() {
        return sanitizeQueryValue;
    }
});
const _mongoose = /*#__PURE__*/ _interop_require_default(require("mongoose"));
const _utilities = require("payload/utilities");
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const handleHasManyValues = (formattedValue)=>{
    return formattedValue.reduce((formattedValues, inVal)=>{
        const newValues = [
            inVal
        ];
        if (_mongoose.default.Types.ObjectId.isValid(inVal)) {
            newValues.push(new _mongoose.default.Types.ObjectId(inVal));
        }
        const parsedNumber = parseFloat(inVal);
        if (!Number.isNaN(parsedNumber)) {
            newValues.push(parsedNumber);
        }
        return [
            ...formattedValues,
            ...newValues
        ];
    }, []);
};
const handleNonHasManyValues = (formattedValue, operator, path)=>{
    const formattedQueries = formattedValue.map((inVal)=>{
        if (inVal && typeof inVal === 'object' && 'relationTo' in inVal && 'value' in inVal) {
            if (operator === 'in') {
                return {
                    [`${path}.relationTo`]: {
                        $eq: inVal.relationTo
                    },
                    [`${path}.value`]: {
                        $eq: inVal.value
                    }
                };
            } else if (operator === 'not_in') {
                return {
                    $and: [
                        {
                            [`${path}.value`]: inVal.value
                        },
                        {
                            [`${path}.relationTo`]: inVal.relationTo
                        }
                    ]
                };
            }
        }
        return null;
    }).filter(Boolean);
    if (formattedQueries.length > 0) {
        return {
            rawQuery: operator === 'in' ? {
                $or: formattedQueries
            } : {
                $nor: formattedQueries
            }
        };
    }
};
const buildExistsQuery = (formattedValue, path)=>{
    if (formattedValue) {
        return {
            rawQuery: {
                $and: [
                    {
                        [path]: {
                            $exists: true
                        }
                    },
                    {
                        [path]: {
                            $ne: null
                        }
                    },
                    {
                        [path]: {
                            $ne: ''
                        }
                    }
                ]
            }
        };
    } else {
        return {
            rawQuery: {
                $or: [
                    {
                        [path]: {
                            $exists: false
                        }
                    },
                    {
                        [path]: {
                            $eq: null
                        }
                    },
                    {
                        [path]: {
                            $eq: ''
                        }
                    }
                ]
            }
        };
    }
};
const sanitizeQueryValue = ({ field, hasCustomID, operator, path, val })=>{
    let formattedValue = val;
    let formattedOperator = operator;
    // Disregard invalid _ids
    if (path === '_id' && typeof val === 'string' && val.split(',').length === 1) {
        if (!hasCustomID) {
            const isValid = _mongoose.default.Types.ObjectId.isValid(val);
            if (!isValid) {
                return {
                    operator: formattedOperator,
                    val: undefined
                };
            }
        }
        if (field.type === 'number') {
            const parsedNumber = parseFloat(val);
            if (Number.isNaN(parsedNumber)) {
                return {
                    operator: formattedOperator,
                    val: undefined
                };
            }
        }
    }
    // Cast incoming values as proper searchable types
    if (field.type === 'checkbox' && typeof val === 'string') {
        if (val.toLowerCase() === 'true') formattedValue = true;
        if (val.toLowerCase() === 'false') formattedValue = false;
    }
    if ([
        'all',
        'in',
        'not_in'
    ].includes(operator) && typeof formattedValue === 'string') {
        formattedValue = (0, _utilities.createArrayFromCommaDelineated)(formattedValue);
        if (field.type === 'number') {
            formattedValue = formattedValue.map((arrayVal)=>parseFloat(arrayVal));
        }
    }
    if (field.type === 'number') {
        if (typeof formattedValue === 'string' && operator !== 'exists') {
            formattedValue = Number(val);
        }
        if (operator === 'exists') {
            formattedValue = val === 'true' ? true : val === 'false' ? false : Boolean(val);
            return buildExistsQuery(formattedValue, path);
        }
    }
    if (field.type === 'date' && typeof val === 'string' && operator !== 'exists') {
        formattedValue = new Date(val);
        if (Number.isNaN(Date.parse(formattedValue))) {
            return undefined;
        }
    }
    if ([
        'relationship',
        'upload'
    ].includes(field.type)) {
        if (val === 'null') {
            formattedValue = null;
        }
        // Object equality requires the value to be the first key in the object that is being queried.
        if (operator === 'equals' && formattedValue && typeof formattedValue === 'object' && formattedValue.value && formattedValue.relationTo) {
            return {
                rawQuery: {
                    $and: [
                        {
                            [`${path}.value`]: {
                                $eq: formattedValue.value
                            }
                        },
                        {
                            [`${path}.relationTo`]: {
                                $eq: formattedValue.relationTo
                            }
                        }
                    ]
                }
            };
        }
        if ([
            'in',
            'not_in'
        ].includes(operator) && Array.isArray(formattedValue)) {
            if ('hasMany' in field && field.hasMany) {
                formattedValue = handleHasManyValues(formattedValue);
            } else {
                const result = handleNonHasManyValues(formattedValue, operator, path);
                if (result) {
                    return result;
                }
            }
        }
    }
    // Set up specific formatting necessary by operators
    if (operator === 'near') {
        let lng;
        let lat;
        let maxDistance;
        let minDistance;
        if (Array.isArray(formattedValue)) {
            [lng, lat, maxDistance, minDistance] = formattedValue;
        }
        if (typeof formattedValue === 'string') {
            [lng, lat, maxDistance, minDistance] = (0, _utilities.createArrayFromCommaDelineated)(formattedValue);
        }
        if (lng == null || lat == null || maxDistance == null && minDistance == null) {
            formattedValue = undefined;
        } else {
            formattedValue = {
                $geometry: {
                    type: 'Point',
                    coordinates: [
                        parseFloat(lng),
                        parseFloat(lat)
                    ]
                }
            };
            if (maxDistance) formattedValue.$maxDistance = parseFloat(maxDistance);
            if (minDistance) formattedValue.$minDistance = parseFloat(minDistance);
        }
    }
    if (operator === 'within' || operator === 'intersects') {
        formattedValue = {
            $geometry: formattedValue
        };
    }
    if (path !== '_id' || path === '_id' && hasCustomID && field.type === 'text') {
        if (operator === 'contains') {
            formattedValue = {
                $options: 'i',
                $regex: formattedValue.replace(/[\\^$*+?.()|[\]{}]/g, '\\$&')
            };
        }
        if (operator === 'exists') {
            formattedValue = formattedValue === 'true' || formattedValue === true;
            return buildExistsQuery(formattedValue, path);
        }
    }
    if ((path === '_id' || path === 'parent') && operator === 'like' && formattedValue.length === 24 && !hasCustomID) {
        formattedOperator = 'equals';
    }
    if (operator === 'exists') {
        formattedValue = formattedValue === 'true' || formattedValue === true;
        // Clearable fields
        if ([
            'relationship',
            'select',
            'upload'
        ].includes(field.type)) {
            if (formattedValue) {
                return {
                    rawQuery: {
                        $and: [
                            {
                                [path]: {
                                    $exists: true
                                }
                            },
                            {
                                [path]: {
                                    $ne: null
                                }
                            }
                        ]
                    }
                };
            } else {
                return {
                    rawQuery: {
                        $or: [
                            {
                                [path]: {
                                    $exists: false
                                }
                            },
                            {
                                [path]: {
                                    $eq: null
                                }
                            }
                        ]
                    }
                };
            }
        }
    }
    return {
        operator: formattedOperator,
        val: formattedValue
    };
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9xdWVyaWVzL3Nhbml0aXplUXVlcnlWYWx1ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IEZpZWxkLCBUYWJBc0ZpZWxkIH0gZnJvbSAncGF5bG9hZC90eXBlcydcblxuaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJ1xuaW1wb3J0IHsgY3JlYXRlQXJyYXlGcm9tQ29tbWFEZWxpbmVhdGVkIH0gZnJvbSAncGF5bG9hZC91dGlsaXRpZXMnXG5cbnR5cGUgU2FuaXRpemVRdWVyeVZhbHVlQXJncyA9IHtcbiAgZmllbGQ6IEZpZWxkIHwgVGFiQXNGaWVsZFxuICBoYXNDdXN0b21JRDogYm9vbGVhblxuICBvcGVyYXRvcjogc3RyaW5nXG4gIHBhdGg6IHN0cmluZ1xuICB2YWw6IGFueVxufVxuXG5jb25zdCBoYW5kbGVIYXNNYW55VmFsdWVzID0gKGZvcm1hdHRlZFZhbHVlKSA9PiB7XG4gIHJldHVybiBmb3JtYXR0ZWRWYWx1ZS5yZWR1Y2UoKGZvcm1hdHRlZFZhbHVlcywgaW5WYWwpID0+IHtcbiAgICBjb25zdCBuZXdWYWx1ZXMgPSBbaW5WYWxdXG4gICAgaWYgKG1vbmdvb3NlLlR5cGVzLk9iamVjdElkLmlzVmFsaWQoaW5WYWwpKSB7XG4gICAgICBuZXdWYWx1ZXMucHVzaChuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQoaW5WYWwpKVxuICAgIH1cbiAgICBjb25zdCBwYXJzZWROdW1iZXIgPSBwYXJzZUZsb2F0KGluVmFsKVxuICAgIGlmICghTnVtYmVyLmlzTmFOKHBhcnNlZE51bWJlcikpIHtcbiAgICAgIG5ld1ZhbHVlcy5wdXNoKHBhcnNlZE51bWJlcilcbiAgICB9XG5cbiAgICByZXR1cm4gWy4uLmZvcm1hdHRlZFZhbHVlcywgLi4ubmV3VmFsdWVzXVxuICB9LCBbXSlcbn1cblxuY29uc3QgaGFuZGxlTm9uSGFzTWFueVZhbHVlcyA9IChmb3JtYXR0ZWRWYWx1ZSwgb3BlcmF0b3IsIHBhdGgpID0+IHtcbiAgY29uc3QgZm9ybWF0dGVkUXVlcmllcyA9IGZvcm1hdHRlZFZhbHVlXG4gICAgLm1hcCgoaW5WYWwpID0+IHtcbiAgICAgIGlmIChpblZhbCAmJiB0eXBlb2YgaW5WYWwgPT09ICdvYmplY3QnICYmICdyZWxhdGlvblRvJyBpbiBpblZhbCAmJiAndmFsdWUnIGluIGluVmFsKSB7XG4gICAgICAgIGlmIChvcGVyYXRvciA9PT0gJ2luJykge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBbYCR7cGF0aH0ucmVsYXRpb25Ub2BdOiB7ICRlcTogaW5WYWwucmVsYXRpb25UbyB9LFxuICAgICAgICAgICAgW2Ake3BhdGh9LnZhbHVlYF06IHsgJGVxOiBpblZhbC52YWx1ZSB9LFxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChvcGVyYXRvciA9PT0gJ25vdF9pbicpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgJGFuZDogW1xuICAgICAgICAgICAgICB7IFtgJHtwYXRofS52YWx1ZWBdOiBpblZhbC52YWx1ZSB9LFxuICAgICAgICAgICAgICB7IFtgJHtwYXRofS5yZWxhdGlvblRvYF06IGluVmFsLnJlbGF0aW9uVG8gfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbFxuICAgIH0pXG4gICAgLmZpbHRlcihCb29sZWFuKVxuXG4gIGlmIChmb3JtYXR0ZWRRdWVyaWVzLmxlbmd0aCA+IDApIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmF3UXVlcnk6IG9wZXJhdG9yID09PSAnaW4nID8geyAkb3I6IGZvcm1hdHRlZFF1ZXJpZXMgfSA6IHsgJG5vcjogZm9ybWF0dGVkUXVlcmllcyB9LFxuICAgIH1cbiAgfVxufVxuXG5jb25zdCBidWlsZEV4aXN0c1F1ZXJ5ID0gKGZvcm1hdHRlZFZhbHVlLCBwYXRoKSA9PiB7XG4gIGlmIChmb3JtYXR0ZWRWYWx1ZSkge1xuICAgIHJldHVybiB7XG4gICAgICByYXdRdWVyeToge1xuICAgICAgICAkYW5kOiBbXG4gICAgICAgICAgeyBbcGF0aF06IHsgJGV4aXN0czogdHJ1ZSB9IH0sXG4gICAgICAgICAgeyBbcGF0aF06IHsgJG5lOiBudWxsIH0gfSxcbiAgICAgICAgICB7IFtwYXRoXTogeyAkbmU6ICcnIH0gfSwgLy8gRXhjbHVkZSBudWxsIGFuZCBlbXB0eSBzdHJpbmdcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiB7XG4gICAgICByYXdRdWVyeToge1xuICAgICAgICAkb3I6IFtcbiAgICAgICAgICB7IFtwYXRoXTogeyAkZXhpc3RzOiBmYWxzZSB9IH0sXG4gICAgICAgICAgeyBbcGF0aF06IHsgJGVxOiBudWxsIH0gfSxcbiAgICAgICAgICB7IFtwYXRoXTogeyAkZXE6ICcnIH0gfSwgLy8gVHJlYXQgZW1wdHkgc3RyaW5nIGFzIG51bGwgLyB1bmRlZmluZWRcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjb25zdCBzYW5pdGl6ZVF1ZXJ5VmFsdWUgPSAoe1xuICBmaWVsZCxcbiAgaGFzQ3VzdG9tSUQsXG4gIG9wZXJhdG9yLFxuICBwYXRoLFxuICB2YWwsXG59OiBTYW5pdGl6ZVF1ZXJ5VmFsdWVBcmdzKToge1xuICBvcGVyYXRvcj86IHN0cmluZ1xuICByYXdRdWVyeT86IHVua25vd25cbiAgdmFsPzogdW5rbm93blxufSA9PiB7XG4gIGxldCBmb3JtYXR0ZWRWYWx1ZSA9IHZhbFxuICBsZXQgZm9ybWF0dGVkT3BlcmF0b3IgPSBvcGVyYXRvclxuXG4gIC8vIERpc3JlZ2FyZCBpbnZhbGlkIF9pZHNcbiAgaWYgKHBhdGggPT09ICdfaWQnICYmIHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnICYmIHZhbC5zcGxpdCgnLCcpLmxlbmd0aCA9PT0gMSkge1xuICAgIGlmICghaGFzQ3VzdG9tSUQpIHtcbiAgICAgIGNvbnN0IGlzVmFsaWQgPSBtb25nb29zZS5UeXBlcy5PYmplY3RJZC5pc1ZhbGlkKHZhbClcblxuICAgICAgaWYgKCFpc1ZhbGlkKSB7XG4gICAgICAgIHJldHVybiB7IG9wZXJhdG9yOiBmb3JtYXR0ZWRPcGVyYXRvciwgdmFsOiB1bmRlZmluZWQgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChmaWVsZC50eXBlID09PSAnbnVtYmVyJykge1xuICAgICAgY29uc3QgcGFyc2VkTnVtYmVyID0gcGFyc2VGbG9hdCh2YWwpXG5cbiAgICAgIGlmIChOdW1iZXIuaXNOYU4ocGFyc2VkTnVtYmVyKSkge1xuICAgICAgICByZXR1cm4geyBvcGVyYXRvcjogZm9ybWF0dGVkT3BlcmF0b3IsIHZhbDogdW5kZWZpbmVkIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBDYXN0IGluY29taW5nIHZhbHVlcyBhcyBwcm9wZXIgc2VhcmNoYWJsZSB0eXBlc1xuICBpZiAoZmllbGQudHlwZSA9PT0gJ2NoZWNrYm94JyAmJiB0eXBlb2YgdmFsID09PSAnc3RyaW5nJykge1xuICAgIGlmICh2YWwudG9Mb3dlckNhc2UoKSA9PT0gJ3RydWUnKSBmb3JtYXR0ZWRWYWx1ZSA9IHRydWVcbiAgICBpZiAodmFsLnRvTG93ZXJDYXNlKCkgPT09ICdmYWxzZScpIGZvcm1hdHRlZFZhbHVlID0gZmFsc2VcbiAgfVxuXG4gIGlmIChbJ2FsbCcsICdpbicsICdub3RfaW4nXS5pbmNsdWRlcyhvcGVyYXRvcikgJiYgdHlwZW9mIGZvcm1hdHRlZFZhbHVlID09PSAnc3RyaW5nJykge1xuICAgIGZvcm1hdHRlZFZhbHVlID0gY3JlYXRlQXJyYXlGcm9tQ29tbWFEZWxpbmVhdGVkKGZvcm1hdHRlZFZhbHVlKVxuXG4gICAgaWYgKGZpZWxkLnR5cGUgPT09ICdudW1iZXInKSB7XG4gICAgICBmb3JtYXR0ZWRWYWx1ZSA9IGZvcm1hdHRlZFZhbHVlLm1hcCgoYXJyYXlWYWwpID0+IHBhcnNlRmxvYXQoYXJyYXlWYWwpKVxuICAgIH1cbiAgfVxuXG4gIGlmIChmaWVsZC50eXBlID09PSAnbnVtYmVyJykge1xuICAgIGlmICh0eXBlb2YgZm9ybWF0dGVkVmFsdWUgPT09ICdzdHJpbmcnICYmIG9wZXJhdG9yICE9PSAnZXhpc3RzJykge1xuICAgICAgZm9ybWF0dGVkVmFsdWUgPSBOdW1iZXIodmFsKVxuICAgIH1cblxuICAgIGlmIChvcGVyYXRvciA9PT0gJ2V4aXN0cycpIHtcbiAgICAgIGZvcm1hdHRlZFZhbHVlID0gdmFsID09PSAndHJ1ZScgPyB0cnVlIDogdmFsID09PSAnZmFsc2UnID8gZmFsc2UgOiBCb29sZWFuKHZhbClcblxuICAgICAgcmV0dXJuIGJ1aWxkRXhpc3RzUXVlcnkoZm9ybWF0dGVkVmFsdWUsIHBhdGgpXG4gICAgfVxuICB9XG5cbiAgaWYgKGZpZWxkLnR5cGUgPT09ICdkYXRlJyAmJiB0eXBlb2YgdmFsID09PSAnc3RyaW5nJyAmJiBvcGVyYXRvciAhPT0gJ2V4aXN0cycpIHtcbiAgICBmb3JtYXR0ZWRWYWx1ZSA9IG5ldyBEYXRlKHZhbClcbiAgICBpZiAoTnVtYmVyLmlzTmFOKERhdGUucGFyc2UoZm9ybWF0dGVkVmFsdWUpKSkge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZFxuICAgIH1cbiAgfVxuXG4gIGlmIChbJ3JlbGF0aW9uc2hpcCcsICd1cGxvYWQnXS5pbmNsdWRlcyhmaWVsZC50eXBlKSkge1xuICAgIGlmICh2YWwgPT09ICdudWxsJykge1xuICAgICAgZm9ybWF0dGVkVmFsdWUgPSBudWxsXG4gICAgfVxuXG4gICAgLy8gT2JqZWN0IGVxdWFsaXR5IHJlcXVpcmVzIHRoZSB2YWx1ZSB0byBiZSB0aGUgZmlyc3Qga2V5IGluIHRoZSBvYmplY3QgdGhhdCBpcyBiZWluZyBxdWVyaWVkLlxuICAgIGlmIChcbiAgICAgIG9wZXJhdG9yID09PSAnZXF1YWxzJyAmJlxuICAgICAgZm9ybWF0dGVkVmFsdWUgJiZcbiAgICAgIHR5cGVvZiBmb3JtYXR0ZWRWYWx1ZSA9PT0gJ29iamVjdCcgJiZcbiAgICAgIGZvcm1hdHRlZFZhbHVlLnZhbHVlICYmXG4gICAgICBmb3JtYXR0ZWRWYWx1ZS5yZWxhdGlvblRvXG4gICAgKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByYXdRdWVyeToge1xuICAgICAgICAgICRhbmQ6IFtcbiAgICAgICAgICAgIHsgW2Ake3BhdGh9LnZhbHVlYF06IHsgJGVxOiBmb3JtYXR0ZWRWYWx1ZS52YWx1ZSB9IH0sXG4gICAgICAgICAgICB7IFtgJHtwYXRofS5yZWxhdGlvblRvYF06IHsgJGVxOiBmb3JtYXR0ZWRWYWx1ZS5yZWxhdGlvblRvIH0gfSxcbiAgICAgICAgICBdLFxuICAgICAgICB9LFxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChbJ2luJywgJ25vdF9pbiddLmluY2x1ZGVzKG9wZXJhdG9yKSAmJiBBcnJheS5pc0FycmF5KGZvcm1hdHRlZFZhbHVlKSkge1xuICAgICAgaWYgKCdoYXNNYW55JyBpbiBmaWVsZCAmJiBmaWVsZC5oYXNNYW55KSB7XG4gICAgICAgIGZvcm1hdHRlZFZhbHVlID0gaGFuZGxlSGFzTWFueVZhbHVlcyhmb3JtYXR0ZWRWYWx1ZSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGhhbmRsZU5vbkhhc01hbnlWYWx1ZXMoZm9ybWF0dGVkVmFsdWUsIG9wZXJhdG9yLCBwYXRoKVxuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgcmV0dXJuIHJlc3VsdFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gU2V0IHVwIHNwZWNpZmljIGZvcm1hdHRpbmcgbmVjZXNzYXJ5IGJ5IG9wZXJhdG9yc1xuXG4gIGlmIChvcGVyYXRvciA9PT0gJ25lYXInKSB7XG4gICAgbGV0IGxuZ1xuICAgIGxldCBsYXRcbiAgICBsZXQgbWF4RGlzdGFuY2VcbiAgICBsZXQgbWluRGlzdGFuY2VcblxuICAgIGlmIChBcnJheS5pc0FycmF5KGZvcm1hdHRlZFZhbHVlKSkge1xuICAgICAgO1tsbmcsIGxhdCwgbWF4RGlzdGFuY2UsIG1pbkRpc3RhbmNlXSA9IGZvcm1hdHRlZFZhbHVlXG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBmb3JtYXR0ZWRWYWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIDtbbG5nLCBsYXQsIG1heERpc3RhbmNlLCBtaW5EaXN0YW5jZV0gPSBjcmVhdGVBcnJheUZyb21Db21tYURlbGluZWF0ZWQoZm9ybWF0dGVkVmFsdWUpXG4gICAgfVxuXG4gICAgaWYgKGxuZyA9PSBudWxsIHx8IGxhdCA9PSBudWxsIHx8IChtYXhEaXN0YW5jZSA9PSBudWxsICYmIG1pbkRpc3RhbmNlID09IG51bGwpKSB7XG4gICAgICBmb3JtYXR0ZWRWYWx1ZSA9IHVuZGVmaW5lZFxuICAgIH0gZWxzZSB7XG4gICAgICBmb3JtYXR0ZWRWYWx1ZSA9IHtcbiAgICAgICAgJGdlb21ldHJ5OiB7IHR5cGU6ICdQb2ludCcsIGNvb3JkaW5hdGVzOiBbcGFyc2VGbG9hdChsbmcpLCBwYXJzZUZsb2F0KGxhdCldIH0sXG4gICAgICB9XG5cbiAgICAgIGlmIChtYXhEaXN0YW5jZSkgZm9ybWF0dGVkVmFsdWUuJG1heERpc3RhbmNlID0gcGFyc2VGbG9hdChtYXhEaXN0YW5jZSlcbiAgICAgIGlmIChtaW5EaXN0YW5jZSkgZm9ybWF0dGVkVmFsdWUuJG1pbkRpc3RhbmNlID0gcGFyc2VGbG9hdChtaW5EaXN0YW5jZSlcbiAgICB9XG4gIH1cblxuICBpZiAob3BlcmF0b3IgPT09ICd3aXRoaW4nIHx8IG9wZXJhdG9yID09PSAnaW50ZXJzZWN0cycpIHtcbiAgICBmb3JtYXR0ZWRWYWx1ZSA9IHtcbiAgICAgICRnZW9tZXRyeTogZm9ybWF0dGVkVmFsdWUsXG4gICAgfVxuICB9XG5cbiAgaWYgKHBhdGggIT09ICdfaWQnIHx8IChwYXRoID09PSAnX2lkJyAmJiBoYXNDdXN0b21JRCAmJiBmaWVsZC50eXBlID09PSAndGV4dCcpKSB7XG4gICAgaWYgKG9wZXJhdG9yID09PSAnY29udGFpbnMnKSB7XG4gICAgICBmb3JtYXR0ZWRWYWx1ZSA9IHtcbiAgICAgICAgJG9wdGlvbnM6ICdpJyxcbiAgICAgICAgJHJlZ2V4OiBmb3JtYXR0ZWRWYWx1ZS5yZXBsYWNlKC9bXFxcXF4kKis/LigpfFtcXF17fV0vZywgJ1xcXFwkJicpLFxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvcGVyYXRvciA9PT0gJ2V4aXN0cycpIHtcbiAgICAgIGZvcm1hdHRlZFZhbHVlID0gZm9ybWF0dGVkVmFsdWUgPT09ICd0cnVlJyB8fCBmb3JtYXR0ZWRWYWx1ZSA9PT0gdHJ1ZVxuXG4gICAgICByZXR1cm4gYnVpbGRFeGlzdHNRdWVyeShmb3JtYXR0ZWRWYWx1ZSwgcGF0aClcbiAgICB9XG4gIH1cblxuICBpZiAoXG4gICAgKHBhdGggPT09ICdfaWQnIHx8IHBhdGggPT09ICdwYXJlbnQnKSAmJlxuICAgIG9wZXJhdG9yID09PSAnbGlrZScgJiZcbiAgICBmb3JtYXR0ZWRWYWx1ZS5sZW5ndGggPT09IDI0ICYmXG4gICAgIWhhc0N1c3RvbUlEXG4gICkge1xuICAgIGZvcm1hdHRlZE9wZXJhdG9yID0gJ2VxdWFscydcbiAgfVxuXG4gIGlmIChvcGVyYXRvciA9PT0gJ2V4aXN0cycpIHtcbiAgICBmb3JtYXR0ZWRWYWx1ZSA9IGZvcm1hdHRlZFZhbHVlID09PSAndHJ1ZScgfHwgZm9ybWF0dGVkVmFsdWUgPT09IHRydWVcblxuICAgIC8vIENsZWFyYWJsZSBmaWVsZHNcbiAgICBpZiAoWydyZWxhdGlvbnNoaXAnLCAnc2VsZWN0JywgJ3VwbG9hZCddLmluY2x1ZGVzKGZpZWxkLnR5cGUpKSB7XG4gICAgICBpZiAoZm9ybWF0dGVkVmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICByYXdRdWVyeToge1xuICAgICAgICAgICAgJGFuZDogW3sgW3BhdGhdOiB7ICRleGlzdHM6IHRydWUgfSB9LCB7IFtwYXRoXTogeyAkbmU6IG51bGwgfSB9XSxcbiAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHJhd1F1ZXJ5OiB7XG4gICAgICAgICAgICAkb3I6IFt7IFtwYXRoXTogeyAkZXhpc3RzOiBmYWxzZSB9IH0sIHsgW3BhdGhdOiB7ICRlcTogbnVsbCB9IH1dLFxuICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4geyBvcGVyYXRvcjogZm9ybWF0dGVkT3BlcmF0b3IsIHZhbDogZm9ybWF0dGVkVmFsdWUgfVxufVxuIl0sIm5hbWVzIjpbInNhbml0aXplUXVlcnlWYWx1ZSIsImhhbmRsZUhhc01hbnlWYWx1ZXMiLCJmb3JtYXR0ZWRWYWx1ZSIsInJlZHVjZSIsImZvcm1hdHRlZFZhbHVlcyIsImluVmFsIiwibmV3VmFsdWVzIiwibW9uZ29vc2UiLCJUeXBlcyIsIk9iamVjdElkIiwiaXNWYWxpZCIsInB1c2giLCJwYXJzZWROdW1iZXIiLCJwYXJzZUZsb2F0IiwiTnVtYmVyIiwiaXNOYU4iLCJoYW5kbGVOb25IYXNNYW55VmFsdWVzIiwib3BlcmF0b3IiLCJwYXRoIiwiZm9ybWF0dGVkUXVlcmllcyIsIm1hcCIsIiRlcSIsInJlbGF0aW9uVG8iLCJ2YWx1ZSIsIiRhbmQiLCJmaWx0ZXIiLCJCb29sZWFuIiwibGVuZ3RoIiwicmF3UXVlcnkiLCIkb3IiLCIkbm9yIiwiYnVpbGRFeGlzdHNRdWVyeSIsIiRleGlzdHMiLCIkbmUiLCJmaWVsZCIsImhhc0N1c3RvbUlEIiwidmFsIiwiZm9ybWF0dGVkT3BlcmF0b3IiLCJzcGxpdCIsInVuZGVmaW5lZCIsInR5cGUiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwiY3JlYXRlQXJyYXlGcm9tQ29tbWFEZWxpbmVhdGVkIiwiYXJyYXlWYWwiLCJEYXRlIiwicGFyc2UiLCJBcnJheSIsImlzQXJyYXkiLCJoYXNNYW55IiwicmVzdWx0IiwibG5nIiwibGF0IiwibWF4RGlzdGFuY2UiLCJtaW5EaXN0YW5jZSIsIiRnZW9tZXRyeSIsImNvb3JkaW5hdGVzIiwiJG1heERpc3RhbmNlIiwiJG1pbkRpc3RhbmNlIiwiJG9wdGlvbnMiLCIkcmVnZXgiLCJyZXBsYWNlIl0sInJhbmdlTWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7IiwibWFwcGluZ3MiOiI7Ozs7K0JBaUZhQTs7O2VBQUFBOzs7aUVBL0VROzJCQUMwQjs7Ozs7O0FBVS9DLE1BQU1DLHNCQUFzQixDQUFDQztJQUMzQixPQUFPQSxlQUFlQyxNQUFNLENBQUMsQ0FBQ0MsaUJBQWlCQztRQUM3QyxNQUFNQyxZQUFZO1lBQUNEO1NBQU07UUFDekIsSUFBSUUsaUJBQVEsQ0FBQ0MsS0FBSyxDQUFDQyxRQUFRLENBQUNDLE9BQU8sQ0FBQ0wsUUFBUTtZQUMxQ0MsVUFBVUssSUFBSSxDQUFDLElBQUlKLGlCQUFRLENBQUNDLEtBQUssQ0FBQ0MsUUFBUSxDQUFDSjtRQUM3QztRQUNBLE1BQU1PLGVBQWVDLFdBQVdSO1FBQ2hDLElBQUksQ0FBQ1MsT0FBT0MsS0FBSyxDQUFDSCxlQUFlO1lBQy9CTixVQUFVSyxJQUFJLENBQUNDO1FBQ2pCO1FBRUEsT0FBTztlQUFJUjtlQUFvQkU7U0FBVTtJQUMzQyxHQUFHLEVBQUU7QUFDUDtBQUVBLE1BQU1VLHlCQUF5QixDQUFDZCxnQkFBZ0JlLFVBQVVDO0lBQ3hELE1BQU1DLG1CQUFtQmpCLGVBQ3RCa0IsR0FBRyxDQUFDLENBQUNmO1FBQ0osSUFBSUEsU0FBUyxPQUFPQSxVQUFVLFlBQVksZ0JBQWdC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